<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Stripe PoC</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://js.stripe.com/v3/"></script>
  </head>
  <body>
    <form>
      <div id="card-number"></div>
      <div id="card-expiry"></div>
      <div id="card-cvc"></div>
      <button type="submit">Submit</button>
    </form>

    <div>Result: <span class="result"></span></div>

    <div>
      <a class="reset" href="#">Reset</a>
    </div>

    <script>
      var stripe = Stripe("pk_test_6pRNASCoBOKtIshFeQd4XMUh");

      function registerElements(elements) {
        var form = document.querySelector("form");
        var resetButton = document.querySelector("a.reset");

        async function createToken(elements, callback) {
          const result = await stripe.createToken(elements[0]);
          callback(result);
        }

        form.addEventListener("submit", function (e) {
          e.preventDefault();
          createToken(elements, function (result) {
            if (result.token) {
              document.querySelector(".result").innerText = result.token.id;
            } else {
              document.querySelector(".result").innerText =
                result.error.message;
            }
          });
        });

        function clearForm() {
          form.reset();
          document.querySelector(".result").innerText = "";
          elements.forEach(function (element) {
            element.clear();
          });
        }

        resetButton.addEventListener("click", function (e) {
          e.preventDefault();
          clearForm();
        });
      }

      var elements = stripe.elements({});

      var cardNumber = elements.create("cardNumber");
      cardNumber.mount("#card-number");

      var cardExpiry = elements.create("cardExpiry");
      cardExpiry.mount("#card-expiry");

      var cardCvc = elements.create("cardCvc");
      cardCvc.mount("#card-cvc");

      registerElements([cardNumber, cardExpiry, cardCvc]);
    </script>
  </body>
</html>
